{"ast":null,"code":"import React,{useEffect,useRef,useState,useContext}from\"react\";import\"../styles/car-details.css\";import{Container,Row,Col,Form,ListGroup}from\"reactstrap\";import{useParams}from\"react-router-dom\";import calculateAvgRating from\"../utils/avgRatings\";import avatar from\"../assets/images/avatar.jpg\";import Booking from\"../components/Booking/Booking\";import useFetch from\"../hooks/useFetch\";import{BASE_URL}from\"../utils/config\";import{AuthContext}from\"../context/AuthContext\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const CarDetails=()=>{const{id}=useParams();const reviewMsgRef=useRef(\"\");const[carRating,setcarRating]=useState(null);const{user}=useContext(AuthContext);// const car = carData.find((car) => car.id == id);\nconst{data:car,loading,error}=useFetch(\"\".concat(BASE_URL,\"/cars/\").concat(id));const{photo,title,desc,price,address,reviews,city,distance,maxGroupSize}=car;const{totalRating,avgRating}=calculateAvgRating(reviews);const options={day:\"numeric\",month:\"long\",year:\"numeric\"};const submitHandler=async e=>{e.preventDefault();const reviewText=reviewMsgRef.current.value;try{if(!user||user==undefined||user==null){alert(\"Please sign in\");}const reviewObj={username:user===null||user===void 0?void 0:user.username,reviewText,rating:carRating};const res=await fetch(\"\".concat(BASE_URL,\"/review/\").concat(id),{method:\"post\",headers:{\"content-type\":\"application/json\"},credentials:\"include\",body:JSON.stringify(reviewObj)});const result=await res.json();if(!res.ok){return alert(result.message);}alert(result.message);}catch(err){alert(err.message);}};useEffect(()=>{window.scrollTo(0,0);},[car]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsxs(Container,{children:[loading&&/*#__PURE__*/_jsx(\"h4\",{className:\"text-center pt-5\",children:\"Loading.......\"}),error&&/*#__PURE__*/_jsx(\"h4\",{className:\"text-center pt-5\",children:error}),!loading&&!error&&/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{lg:\"8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"car__content\",children:[/*#__PURE__*/_jsx(\"img\",{src:photo,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"car__info\",children:[/*#__PURE__*/_jsx(\"h2\",{children:title}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center gap-5\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"car__rating d-flex align-items-center gap-1\",style:{color:'black'},children:[/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-fill\",style:{color:\"var(--secondary-color)\"}}),\" \",avgRating==0?null:avgRating,totalRating==0?\"Not Rated\":/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",reviews===null||reviews===void 0?void 0:reviews.length,\")\"]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"car__extra-details\",children:[/*#__PURE__*/_jsxs(\"span\",{style:{color:'black'},children:[/*#__PURE__*/_jsx(\"i\",{class:\"ri-map-pin-2-line\"}),\" \",city]}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'black'},children:[/*#__PURE__*/_jsx(\"i\",{class:\"ri-money-rupee-circle-fill\"}),\" Rs :\",price,\" \"]})]}),/*#__PURE__*/_jsx(\"h5\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"p\",{children:desc})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"car__reviews mt-4\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Reviews (\",reviews===null||reviews===void 0?void 0:reviews.length,\" reviews)\"]}),/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center gap-3 mb-4 rating__group\",children:[/*#__PURE__*/_jsxs(\"span\",{onClick:()=>setcarRating(1),children:[\"1 \",/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-s-fill\"})]}),/*#__PURE__*/_jsxs(\"span\",{onClick:()=>setcarRating(2),children:[\"2 \",/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-s-fill\"})]}),/*#__PURE__*/_jsxs(\"span\",{onClick:()=>setcarRating(3),children:[\"3 \",/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-s-fill\"})]}),/*#__PURE__*/_jsxs(\"span\",{onClick:()=>setcarRating(4),children:[\"4 \",/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-s-fill\"})]}),/*#__PURE__*/_jsxs(\"span\",{onClick:()=>setcarRating(5),children:[\"5 \",/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-s-fill\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"review__input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",ref:reviewMsgRef,placeholder:\"Share your thoughts\",required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"btn primary__btn text-white\",type:\"submit\",children:\"Submit\"})]})]}),/*#__PURE__*/_jsx(ListGroup,{className:\"user__reviews\",children:reviews===null||reviews===void 0?void 0:reviews.map(review=>/*#__PURE__*/_jsxs(\"div\",{className:\"review__item\",children:[/*#__PURE__*/_jsx(\"img\",{src:avatar,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{children:review.username}),/*#__PURE__*/_jsx(\"p\",{children:new Date(review.createdAt).toLocaleDateString(\"en-US\",options)})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"d-flex align-items-center\",children:[review.rating,\" \",/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-s-fill\"})]})]}),/*#__PURE__*/_jsx(\"h6\",{children:review.reviewText})]})]}))})]})]})}),/*#__PURE__*/_jsx(Col,{lg:\"4\",children:/*#__PURE__*/_jsx(Booking,{car:car,avgRating:avgRating})})]})]})})});};export default CarDetails;","map":{"version":3,"names":["React","useEffect","useRef","useState","useContext","Container","Row","Col","Form","ListGroup","useParams","calculateAvgRating","avatar","Booking","useFetch","BASE_URL","AuthContext","CarDetails","id","reviewMsgRef","carRating","setcarRating","user","data","car","loading","error","photo","title","desc","price","address","reviews","city","distance","maxGroupSize","totalRating","avgRating","options","day","month","year","submitHandler","e","preventDefault","reviewText","current","value","undefined","alert","reviewObj","username","rating","res","fetch","method","headers","credentials","body","JSON","stringify","result","json","ok","message","err","window","scrollTo","color","length","map","review","Date","createdAt","toLocaleDateString"],"sources":["C:/Users/geosh/Documents/GitHub/Project-CarDealership-Fsd/frontend/src/pages/CarDetails.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useContext } from \"react\";\nimport \"../styles/car-details.css\";\nimport { Container, Row, Col, Form, ListGroup } from \"reactstrap\";\nimport { useParams } from \"react-router-dom\";\nimport calculateAvgRating from \"../utils/avgRatings\";\nimport avatar from \"../assets/images/avatar.jpg\";\nimport Booking from \"../components/Booking/Booking\";\nimport useFetch from \"../hooks/useFetch\";\nimport { BASE_URL } from \"../utils/config\";\nimport { AuthContext } from \"../context/AuthContext\";\n\nconst CarDetails = () => {\n  const { id } = useParams();\n  const reviewMsgRef = useRef(\"\");\n  const [carRating, setcarRating] = useState(null);\n  const { user } = useContext(AuthContext);\n\n  // const car = carData.find((car) => car.id == id);\n  const { data: car, loading, error } = useFetch(`${BASE_URL}/cars/${id}`);\n\n  const {\n    photo,\n    title,\n    desc,\n    price,\n    address,\n    reviews,\n    city,\n    distance,\n    maxGroupSize,\n  } = car;\n\n  const { totalRating, avgRating } = calculateAvgRating(reviews);\n\n  const options = { day: \"numeric\", month: \"long\", year: \"numeric\" };\n\n  const submitHandler = async (e) => {\n    e.preventDefault();\n    const reviewText = reviewMsgRef.current.value;\n\n    try {\n      if (!user || user == undefined || user == null) {\n        alert(\"Please sign in\");\n      }\n      const reviewObj = {\n        username: user?.username,\n        reviewText,\n        rating: carRating,\n      };\n      const res = await fetch(`${BASE_URL}/review/${id}`, {\n        method: \"post\",\n        headers: {\n          \"content-type\": \"application/json\",\n        },\n        credentials: \"include\",\n        body: JSON.stringify(reviewObj),\n      });\n      const result = await res.json();\n      if (!res.ok) {\n        return alert(result.message);\n      }\n      alert(result.message);\n    } catch (err) {\n      alert(err.message);\n    }\n  };\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [car]);\n\n  return (\n    <>\n      <section>\n        <Container>\n          {loading && <h4 className=\"text-center pt-5\">Loading.......</h4>}\n          {error && <h4 className=\"text-center pt-5\">{error}</h4>}\n\n          {!loading && !error && (\n            <Row>\n              <Col lg=\"8\">\n                <div className=\"car__content\">\n                  <img src={photo} alt=\"\" />\n                  <div className=\"car__info\">\n                    <h2>{title}</h2>\n                    <div className=\"d-flex align-items-center gap-5\">\n                      <span className=\"car__rating d-flex align-items-center gap-1\" style={{ color: 'black' }} >\n                        <i\n                          class=\"ri-star-fill\"\n                          style={{ color: \"var(--secondary-color)\" }}\n                        ></i>{\" \"}\n                        {avgRating == 0 ? null : avgRating}\n                        {totalRating == 0 ? (\n                          \"Not Rated\"\n                        ) : (\n                          <span>({reviews?.length})</span>\n                        )}\n                      </span>\n                    </div>\n                    <div className=\"car__extra-details\">\n                      <span style={{ color: 'black' }}>\n                        <i class=\"ri-map-pin-2-line\"></i> {city}\n                      </span>\n                      <span style={{ color: 'black' }} >\n                      <i class=\"ri-money-rupee-circle-fill\"></i> Rs :{price}{\" \"}\n                      \n                      </span>\n                    </div>\n                    <h5>Description</h5>\n                    <p>{desc}</p>\n                  </div>\n                  {/*=========car reviews section start========*/}\n                  <div className=\"car__reviews mt-4\">\n                    <h4>Reviews ({reviews?.length} reviews)</h4>\n                    <Form onSubmit={submitHandler}>\n                      <div className=\"d-flex align-items-center gap-3 mb-4 rating__group\">\n                        <span onClick={() => setcarRating(1)}>\n                          1 <i class=\"ri-star-s-fill\"></i>\n                        </span>\n                        <span onClick={() => setcarRating(2)}>\n                          2 <i class=\"ri-star-s-fill\"></i>\n                        </span>\n                        <span onClick={() => setcarRating(3)}>\n                          3 <i class=\"ri-star-s-fill\"></i>\n                        </span>\n                        <span onClick={() => setcarRating(4)}>\n                          4 <i class=\"ri-star-s-fill\"></i>\n                        </span>\n                        <span onClick={() => setcarRating(5)}>\n                          5 <i class=\"ri-star-s-fill\"></i>\n                        </span>\n                      </div>\n                      <div className=\"review__input\">\n                        <input\n                          type=\"text\"\n                          ref={reviewMsgRef}\n                          placeholder=\"Share your thoughts\"\n                          required\n                        />\n                        <button\n                          className=\"btn primary__btn text-white\"\n                          type=\"submit\"\n                        >\n                          Submit\n                        </button>\n                      </div>\n                    </Form>\n                    <ListGroup className=\"user__reviews\">\n                      {reviews?.map((review) => (\n                        <div className=\"review__item\">\n                          <img src={avatar} alt=\"\" />\n                          <div className=\"w-100\">\n                            <div className=\"d-flex align-items-center justify-content-between\">\n                              <div>\n                                <h5>{review.username}</h5>\n                                <p>\n                                  {new Date(\n                                    review.createdAt\n                                  ).toLocaleDateString(\"en-US\", options)}\n                                </p>\n                              </div>\n                              <span className=\"d-flex align-items-center\">\n                                {review.rating} <i class=\"ri-star-s-fill\"></i>\n                              </span>\n                            </div>\n                            <h6>{review.reviewText}</h6>\n                          </div>\n                        </div>\n                      ))}\n                    </ListGroup>\n                  </div>\n\n                  {/*=========car reviews section end========*/}\n                </div>\n              </Col>\n              <Col lg=\"4\">\n                <Booking car={car} avgRating={avgRating} />\n              </Col>\n            </Row>\n          )}\n        </Container>\n      </section>\n      \n    </>\n  );\n};\n\nexport default CarDetails;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}