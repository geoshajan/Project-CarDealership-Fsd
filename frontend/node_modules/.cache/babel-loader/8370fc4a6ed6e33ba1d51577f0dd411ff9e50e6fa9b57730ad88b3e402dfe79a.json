{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{BASE_URL}from\"../utils/config\";import\"./bookings.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Bookings=()=>{const[bookings,setBookings]=useState([]);useEffect(()=>{const fetchBookings=async()=>{try{const response=await fetch(\"\".concat(BASE_URL,\"/booking\"),{method:\"GET\",credentials:\"include\"});const data=await response.json();setBookings(data.data);}catch(error){console.error(\"Error fetching bookings:\",error);}};fetchBookings();},[]);const handleAccept=async(bookingId,currentStatus)=>{let newStatus;switch(currentStatus){case\"requested\":newStatus=\"accepted\";break;case\"accepted\":newStatus=\"accepted\";break;case\"paid\":newStatus=\"paid\";break;default:newStatus=\"accepted\";}try{const response=await fetch(\"\".concat(BASE_URL,\"/booking/\").concat(bookingId),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\"},credentials:\"include\",body:JSON.stringify({status:newStatus})});if(response.ok){setBookings(prevBookings=>prevBookings.map(booking=>booking._id===bookingId?{...booking,status:newStatus}:booking));console.log(\"Booking with ID \".concat(bookingId,\" updated to \").concat(newStatus,\" successfully.\"));}else{console.error(\"Error updating booking with ID \".concat(bookingId,\".\"));}}catch(error){console.error(\"Error updating booking:\",error);}};const handleDelete=async bookingId=>{try{const response=await fetch(\"\".concat(BASE_URL,\"/booking/\").concat(bookingId),{method:\"DELETE\",credentials:\"include\"});if(response.ok){setBookings(prevBookings=>prevBookings.filter(booking=>booking._id!==bookingId));console.log(\"Booking with ID \".concat(bookingId,\" deleted successfully.\"));}else{console.error(\"Error deleting booking with ID \".concat(bookingId,\".\"));}}catch(error){console.error(\"Error deleting booking:\",error);}};const renderAcceptButton=(status,bookingId)=>{switch(status){case\"Requested\":return/*#__PURE__*/_jsx(\"button\",{className:\"accept\",onClick:()=>handleAccept(bookingId,status),children:\"Accept\"});case\"accepted\":return/*#__PURE__*/_jsx(\"button\",{className:\"accepted\",disabled:true,children:\"Accepted\"});case\"paid\":return/*#__PURE__*/_jsx(\"button\",{className:\"paid\",disabled:true,children:\"Paid\"});default:return null;}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"All Bookings\"}),bookings.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No bookings available.\"}):/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Sl No\"}),/*#__PURE__*/_jsx(\"th\",{children:\"car Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Client Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"No of Cars\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Booked At\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Manage\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:bookings.map((booking,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:booking.carName}),/*#__PURE__*/_jsx(\"td\",{children:booking.fullName}),/*#__PURE__*/_jsx(\"td\",{children:booking.guestSize}),/*#__PURE__*/_jsx(\"td\",{children:booking.bookAt}),/*#__PURE__*/_jsxs(\"td\",{children:[renderAcceptButton(booking.status,booking._id),/*#__PURE__*/_jsx(\"button\",{className:\"delete\",onClick:()=>handleDelete(booking._id),children:\"Decline\"})]})]},booking._id))})]})]});};export default Bookings;","map":{"version":3,"names":["React","useState","useEffect","BASE_URL","Bookings","bookings","setBookings","fetchBookings","response","fetch","method","credentials","data","json","error","console","handleAccept","bookingId","currentStatus","newStatus","headers","body","JSON","stringify","status","ok","prevBookings","map","booking","_id","log","handleDelete","filter","renderAcceptButton","length","index","carName","fullName","guestSize","bookAt"],"sources":["C:/Users/geosh/Documents/GitHub/Project-CarDealership-Fsd/frontend/src/pages/Bookings.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { BASE_URL } from \"../utils/config\";\r\nimport \"./bookings.css\";\r\n\r\nconst Bookings = () => {\r\n  const [bookings, setBookings] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const fetchBookings = async () => {\r\n      try {\r\n        const response = await fetch(`${BASE_URL}/booking`, {\r\n          method: \"GET\",\r\n          credentials: \"include\",\r\n        });\r\n        const data = await response.json();\r\n        setBookings(data.data);\r\n      } catch (error) {\r\n        console.error(\"Error fetching bookings:\", error);\r\n      }\r\n    };\r\n\r\n    fetchBookings();\r\n  }, []);\r\n\r\n  const handleAccept = async (bookingId, currentStatus) => {\r\n    let newStatus;\r\n\r\n    switch (currentStatus) {\r\n      case \"requested\":\r\n        newStatus = \"accepted\";\r\n        break;\r\n      case \"accepted\":\r\n        newStatus = \"accepted\";\r\n        break;\r\n      case \"paid\":\r\n        newStatus = \"paid\";\r\n        break;\r\n      default:\r\n        newStatus = \"accepted\";\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${BASE_URL}/booking/${bookingId}`, {\r\n        method: \"PATCH\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        credentials: \"include\",\r\n        body: JSON.stringify({ status: newStatus }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        setBookings((prevBookings) =>\r\n          prevBookings.map((booking) =>\r\n            booking._id === bookingId\r\n              ? { ...booking, status: newStatus }\r\n              : booking\r\n          )\r\n        );\r\n        console.log(\r\n          `Booking with ID ${bookingId} updated to ${newStatus} successfully.`\r\n        );\r\n      } else {\r\n        console.error(`Error updating booking with ID ${bookingId}.`);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error updating booking:\", error);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (bookingId) => {\r\n    try {\r\n      const response = await fetch(`${BASE_URL}/booking/${bookingId}`, {\r\n        method: \"DELETE\",\r\n        credentials: \"include\",\r\n      });\r\n\r\n      if (response.ok) {\r\n        setBookings((prevBookings) =>\r\n          prevBookings.filter((booking) => booking._id !== bookingId)\r\n        );\r\n        console.log(`Booking with ID ${bookingId} deleted successfully.`);\r\n      } else {\r\n        console.error(`Error deleting booking with ID ${bookingId}.`);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error deleting booking:\", error);\r\n    }\r\n  };\r\n\r\n  const renderAcceptButton = (status, bookingId) => {\r\n    switch (status) {\r\n      case \"Requested\":\r\n        return (\r\n          <button\r\n            className=\"accept\"\r\n            onClick={() => handleAccept(bookingId, status)}\r\n          >\r\n            Accept\r\n          </button>\r\n        );\r\n      case \"accepted\":\r\n        return (\r\n          <button className=\"accepted\" disabled>\r\n            Accepted\r\n          </button>\r\n        );\r\n      case \"paid\":\r\n        return (\r\n          <button className=\"paid\" disabled>\r\n            Paid\r\n          </button>\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>All Bookings</h2>\r\n      {bookings.length === 0 ? (\r\n        <p>No bookings available.</p>\r\n      ) : (\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>Sl No</th>\r\n              <th>car Name</th>\r\n              <th>Client Name</th>\r\n              <th>No of Cars</th>\r\n              <th>Booked At</th>\r\n              <th>Manage</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {bookings.map((booking, index) => (\r\n              <tr key={booking._id}>\r\n                <td>{index + 1}</td>\r\n                <td>{booking.carName}</td>\r\n                <td>{booking.fullName}</td>\r\n                <td>{booking.guestSize}</td>\r\n                <td>{booking.bookAt}</td>\r\n                <td>\r\n                  {renderAcceptButton(booking.status, booking._id)}\r\n                  <button\r\n                    className=\"delete\"\r\n                    onClick={() => handleDelete(booking._id)}\r\n                  >\r\n                    Decline\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Bookings;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}